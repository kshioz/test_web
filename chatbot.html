<html>
  <head>
    <title>TEST01</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <h1>Success!</h1>
    <h2>This is for dev!</h2>
    <script>
      const Recognition = window.webkitSpeechRecognition || window.SpeechRecognition;
      const recognition = new Recognition();
      recognition.continuous = false;
      recognition.lang = "ja-JP";
      recognition.interimResults = true; // 解析中の結果を表示する
      recognition.continuous = true; // 認識のたびに継続的に結果を返す

      const startSoeechText = () => {
        recognition.start();
        console.log('start');
      }

      const endSpeechText = () => {
        recognition.stop();
        console.log('end');
      }

      // 認識した音声の結果を処理するイベントハンドラー
      if (recognition.onresult) {
        recognition.onresult = (event) => {
          for (let i = event.resultIndex; i < event.results.length; i++) {
            let results = event.results;
            if (results[i].isFinal) {
              console.log('解析終了');
              // 解析が終了したあとの処理
              console.log(event.results[i][0].transcript);
              endSpeechText();
            } else {
              console.log('認識中');
              // 解析中の処理
              // console.log(event.results[i][0].transcript);
            }
          }
        }
      }

      if (recognition.onaudiostart) {
        recognition.onaudiostart = () => {
          console.log('Audio capturing started onaudiostart')
        }
      }

      if (recognition.onaudioend) {
        recognition.onaudioend = () => {
          console.log("Audio capturing ended onaudioend");
        }
      }

      if (recognition.onerror) {
        recognition.onerror = (event) => {
          console.log('エラーが発生しました。', event.error)
        }
      }

      if (recognition.onnomatch) {
        recognition.onnomatch = () => {
          console.log('認識できませんでした。')
        }
      }
    </script>
    <script
      type="text/javascript"
      src="https://api.chatbox.deca-dev.com/v1/script/01haxd218s50f6yy4jf2f92fzf/01jz9xdejprfsqvzz7enj55wh4">
    </script>
  </body>
</html>
